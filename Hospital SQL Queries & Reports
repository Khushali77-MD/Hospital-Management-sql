**--  Top 5 Doctors with Most Completed Appointments**
SELECT d.name, COUNT(a.appointment_id) AS total_appointments
FROM Doctors d
JOIN Appointments a ON d.doctor_id = a.doctor_id
WHERE a.status = 'Completed'
GROUP BY d.name
ORDER BY total_appointments DESC
LIMIT 5;




--  Total Revenue Generated by Each Department
SELECT dept.name AS department, SUM(b.total_amount) AS total_revenue
FROM Billing b
JOIN Appointments a ON b.appointment_id = a.appointment_id
JOIN Doctors d ON a.doctor_id = d.doctor_id
JOIN Departments dept ON d.department_id = dept.department_id
GROUP BY dept.name
ORDER BY total_revenue DESC;




--  Find the Most Prescribed Medicine
SELECT m.name, COUNT(p.medicine_id) AS prescription_count
FROM Pharmacy p
JOIN Medicine m ON p.medicine_id = m.medicine_id
GROUP BY m.name
ORDER BY prescription_count DESC
LIMIT 1;




--  Find Patients Admitted More Than Once
SELECT patient_id, COUNT(*) AS admission_count
FROM Room_assignments
GROUP BY patient_id
HAVING admission_count > 1;




--  List All Medicines Expiring in the Next 30 Days
SELECT name, expiry_date 
FROM Medicine
WHERE expiry_date BETWEEN CURDATE() AND DATE_ADD(CURDATE(), INTERVAL 30 DAY);
